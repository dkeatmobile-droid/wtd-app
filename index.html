<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
<title>WTD Working Time Tracker</title>

<style>
:root{
--bg:#e5e7eb;
--glass:rgba(255,255,255,.7);
--glassBorder:rgba(255,255,255,.6);
--ok:#16a34a;
--warn:#f59e0b;
--due:#ef4444;
--lampOff:#6b7280;
}

html,body{
margin:0;
height:100%;
font-family:-apple-system,Segoe UI,Roboto;
background:var(--bg);
overflow:hidden;
}

.app{height:100vh;height:100svh;display:flex;flex-direction:column;}

/* ===== HEADER ===== */
header{
padding:calc(12px + env(safe-area-inset-top)) 12px 10px;
background:linear-gradient(180deg,#0b1220,#111827);
color:#fff;
}

.headerRow{display:flex;gap:12px;align-items:flex-start;}

.brand .title{font-weight:900;font-size:15px;}
.brand .status{font-size:12px;opacity:.8;font-weight:800;}

/* ===== TRAFFIC LIGHT ===== */
.signalWrap{display:flex;gap:10px;align-items:flex-start;}
.signalBox{
width:62px;padding:8px;border-radius:22px;
background:#0a0a0a;
box-shadow:inset 0 2px 6px rgba(255,255,255,.05);
}
.signal{display:flex;flex-direction:column;gap:8px;align-items:center;}
.lamp{width:40px;height:40px;border-radius:50%;background:var(--lampOff);box-shadow:inset 0 10px 18px rgba(0,0,0,.6);}
.signalWrap[data-state="ok"] .lamp.green{background:var(--ok);}
.signalWrap[data-state="warn"] .lamp.amber{background:var(--warn);animation:flash 1s infinite;}
.signalWrap[data-state="due"] .lamp.red{background:var(--due);}
@keyframes flash{0%,100%{filter:brightness(1)}50%{filter:brightness(1.3)}}

.sigLabel{font-size:11px;font-weight:800;opacity:0}
.signalWrap[data-state="ok"] .sigLabel.green,
.signalWrap[data-state="warn"] .sigLabel.amber,
.signalWrap[data-state="due"] .sigLabel.red{opacity:1}

/* ===== SHEET ===== */
main{flex:1;padding:12px;}
.sheet{
height:100%;
border-radius:28px 28px 0 0;
background:var(--glass);
border:1px solid var(--glassBorder);
backdrop-filter:blur(20px);
-webkit-backdrop-filter:blur(20px);
box-shadow:0 -10px 40px rgba(0,0,0,.15);
padding:12px;
display:flex;
flex-direction:column;
gap:10px;
}

/* ===== SEGMENTED CONTROL ===== */
.seg{position:relative;display:flex;background:rgba(255,255,255,.6);padding:3px;border-radius:999px;}
.segThumb{position:absolute;top:3px;bottom:3px;left:3px;background:#fff;border-radius:999px;transition:.25s;}
.segBtn{border:0;background:none;padding:8px 12px;font-weight:800;cursor:pointer;z-index:1}

/* ===== BUTTONS ===== */
.controlsRow{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;}
.btn{padding:12px;border-radius:18px;border:1px solid rgba(0,0,0,.1);background:#fff;font-weight:900;}
.btn.primary{background:#0f172a;color:#fff;}
.btn.big{padding:16px;font-size:16px;}
.bigActions{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
.btn.big.active{background:#0f172a;color:#fff;}

/* ===== CARDS ===== */
.miniGrid{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
.card{background:#fff;border-radius:18px;padding:12px;}
.metric{font-size:18px;font-weight:900;margin-top:6px;}

@media(max-height:720px){
.lamp{width:36px;height:36px;}
.metric{font-size:16px;}
.btn.big{padding:14px;font-size:15px;}
}
</style>
</head>

<body>
<div class="app">

<header>
<div class="headerRow">

<div id="signalWrap" class="signalWrap" data-state="off">
<div class="signalBox">
<div class="signal">
<div class="lamp red"></div>
<div class="lamp amber"></div>
<div class="lamp green"></div>
</div>
</div>

<div>
<div class="sigLabel red">STOP — break required</div>
<div class="sigLabel amber">Break upcoming</div>
<div class="sigLabel green">Compliant</div>
</div>
</div>

<div class="brand">
<div class="title">WTD Working Time Tracker</div>
<div id="headerStatus" class="status">Ready</div>
</div>

</div>
</header>

<main>
<div class="sheet">

<div class="controlsRow">
<button id="btnStartShift" class="btn primary">Start shift</button>
<button id="btnEndShift" class="btn">End shift</button>
<button id="btnResetDay" class="btn">Reset day</button>
</div>

<div style="display:flex;justify-content:space-between;align-items:center;">
<div id="segView" class="seg">
<div class="segThumb"></div>
<button class="segBtn" data-value="basic">Basic</button>
<button class="segBtn" data-value="full">Full</button>
</div>

<div id="segShift" class="seg">
<div class="segThumb"></div>
<button class="segBtn" data-value="13">13h</button>
<button class="segBtn" data-value="15">15h</button>
</div>
</div>

<div class="bigActions">
<button id="btnWork" class="btn big">Work</button>
<button id="btnBreak" class="btn big">Break</button>
</div>

<div class="miniGrid">
<div class="card"><div>Shift time</div><div id="uiShiftTime" class="metric">00:00</div></div>
<div class="card"><div>Continuous work</div><div id="uiContinuous" class="metric">00:00</div></div>
<div class="card"><div>Next break</div><div id="uiNextBreakIn" class="metric">—</div></div>
<div class="card"><div>Break needed</div><div id="uiBreakNeeded" class="metric">00:00</div></div>
</div>

</div>
</main>
</div>

<script>
const signalWrap=document.getElementById("signalWrap");
const headerStatus=document.getElementById("headerStatus");
const btnStart=document.getElementById("btnStartShift");
const btnEnd=document.getElementById("btnEndShift");
const btnWork=document.getElementById("btnWork");
const btnBreak=document.getElementById("btnBreak");

let shiftStart=null;
let currentMode=null;

function haptic(){if(navigator.vibrate)navigator.vibrate(10);}

function setState(level,text){
signalWrap.dataset.state=level;
headerStatus.textContent=text;
}

btnStart.onclick=()=>{
if(shiftStart)return;
haptic();
shiftStart=Date.now();
btnStart.textContent="Shift running";
};

btnEnd.onclick=()=>{
haptic();
shiftStart=null;
btnStart.textContent="Start shift";
setState("off","Ready");
};

btnWork.onclick=()=>{
haptic();
currentMode="WORK";
btnWork.classList.add("active");
btnBreak.classList.remove("active");
};

btnBreak.onclick=()=>{
haptic();
currentMode="BREAK";
btnBreak.classList.add("active");
btnWork.classList.remove("active");
};

function initSeg(id){
const seg=document.getElementById(id);
const thumb=seg.querySelector(".segThumb");
const btns=seg.querySelectorAll(".segBtn");
btns.forEach(b=>{
b.onclick=()=>{
haptic();
const r=b.getBoundingClientRect();
const s=seg.getBoundingClientRect();
thumb.style.width=r.width+"px";
thumb.style.transform="translateX("+(r.left-s.left)+"px)";
};
});
setTimeout(()=>btns[0].click(),50);
}
initSeg("segView");
initSeg("segShift");

setInterval(()=>{
if(!shiftStart)return;
const t=(Date.now()-shiftStart)/3600000;
if(t<5.5)setState("ok","Compliant");
else if(t<6)setState("warn","Break soon");
else setState("due","Break due");
},1000);
</script>

</body>
</html>
